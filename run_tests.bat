@echo off
chcp 65001 > nul
cls

echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo โ         MCP SERVER PESSOAL - MENU DE TESTE E EXECUรรO          โ
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.

:menu
echo.
echo Escolha uma opรงรฃo:
echo.
echo [1] ๐งช Testar Servidor (Verificar se estรก funcionando)
echo [2] ๐ Iniciar Servidor (Modo Verbose com Feedback)
echo [3] ๐ Monitor em Tempo Real (NOVO!)
echo [4] ๐ Ver Logs em Tempo Real
echo [5] ๐ Ver Status do Servidor
echo [6] ๐งน Limpar Logs
echo [7] โ Sair
echo.

set /p choice="Digite o nรบmero da opรงรฃo: "

if "%choice%"=="1" goto test
if "%choice%"=="2" goto start
if "%choice%"=="3" goto monitor
if "%choice%"=="4" goto logs
if "%choice%"=="5" goto status
if "%choice%"=="6" goto clean
if "%choice%"=="7" goto end

echo Opรงรฃo invรกlida!
goto menu

:test
cls
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo   ๐งช EXECUTANDO TESTES DO SERVIDOR
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
call venv\Scripts\activate.bat
python test_connection.py
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo   Testes concluรญdos!
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
pause
goto menu

:start
cls
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo   ๐ INICIANDO SERVIDOR MCP (Modo Verbose)
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
echo   O servidor serรก iniciado com feedback visual.
echo   Para parar: Pressione Ctrl+C
echo.
echo   IMPORTANTE: Apรณs iniciar, abra o Claude Desktop
echo   e teste com comandos como "liste minhas tarefas"
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
call venv\Scripts\activate.bat
python main_verbose.py
pause
goto menu

:monitor
cls
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo   ๐ MONITOR EM TEMPO REAL
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
echo   Monitor visual do servidor MCP
echo   Atualiza automaticamente a cada 2 segundos
echo   Pressione Ctrl+C para voltar ao menu
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
call venv\Scripts\activate.bat
python monitor.py
goto menu

:logs
cls
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo   ๐ LOGS EM TEMPO REAL
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
echo   Monitorando: logs\mcp_server.log
echo   Pressione Ctrl+C para voltar ao menu
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
if exist logs\mcp_server.log (
    powershell -Command "Get-Content 'logs\mcp_server.log' -Wait -Tail 50"
) else (
    echo   โ๏ธ  Arquivo de log nรฃo encontrado!
    echo   Execute o servidor primeiro.
    pause
)
goto menu

:status
cls
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo   ๐ STATUS DO SERVIDOR
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.

if exist logs\mcp_server.log (
    echo   ๐ รltimas 20 linhas do log:
    echo   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    echo.
    powershell -Command "Get-Content 'logs\mcp_server.log' -Tail 20"
    echo.
    echo   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
) else (
    echo   โ๏ธ  Nenhum log encontrado. Servidor ainda nรฃo foi iniciado.
)

echo.
if exist data\tasks.json (
    echo   ๐ Banco de dados de tarefas: โ Existe
) else (
    echo   ๐ Banco de dados de tarefas: โ Nรฃo existe (serรก criado)
)

echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
pause
goto menu

:clean
cls
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo   ๐งน LIMPEZA DE LOGS
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.

if exist logs\mcp_server.log (
    del logs\mcp_server.log
    echo   โ Log principal deletado
) else (
    echo   โน๏ธ  Nenhum log encontrado
)

if exist logs\mcp_server.log.1 (
    del logs\mcp_server.log.*
    echo   โ Logs rotativos deletados
)

echo.
echo   Limpeza concluรญda!
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
pause
goto menu

:end
cls
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo   ๐ Atรฉ logo!
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
exit /b
